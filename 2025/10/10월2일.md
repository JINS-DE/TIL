# [2025년 10월 02일] 회고 
## 📝 오늘의 한 줄 요약
골든플래닛 마지막 날, agriedu-ai api서빙 프로젝트 마무리

## 📚 주제별 학습 내용 
### agriedu-ai
- VM에서 Google Discovery Engine에 API 요청을 하기 위해서는 엑세스 권한이 필요하다. 
### Google Discovery Engine API
- [노션링크](https://www.notion.so/Google-Discovery-Engine-API-280c24f07513802eb1f9d39e5ef0ea49?source=copy_link)


## ✨ 오늘 꼭 기억할 것
- Redis 도입 이유 
- Discovery Engine API 호출 방법론

## ✍️ 오늘 돌아보기 끄적끄적
오늘 골든플래닛의 마지막 날이었다. 제로인턴 동기 분의 AI를 통한 영상제작 관련 최종발표 이후 나의 간단한 회고 발표가 있었다. 인턴 생활동안 어떤 작업들을 진행했는지, 어떤 문제들을 만났고 어떤 해결점을 가져갔는지에 대해 고민한 내용들을 발표했다. 

### 농정원 agriedu-ai 프로젝트
추천 AI의 API를 FastAPI로 서빙하는 프로젝트의 초기 프로젝트 세팅과 CI/CD 구축 및 최종 API 서빙까지 완성했었다. 더 고도화해야 부분들이 있지만 시간 관계상 참여하지 못한게 너무나도 아쉬웠다. *일 좀 더 시켜주세요..제발..*

어떻게 고도화 시키실지 사수분께 물어보니까 추천 AI의 각각 하나당 API가 다 돈이기에 REDIS의 TTL을 사용해서 같은 user_id와 이벤트면 REDIS에서 처리해서 API 요청 비용을 줄일 것이라 하셨다. 또한 AWS에 쿠버네티스 서비스인 EKS가 있듯이 구글에도 GKE가 있는데 앞단에 GKE를 도입해서 트래픽을 안정적으로 관리하고 싶으시다고 하셨다. 트래픽을 안정적으로 관리하고 싶으신 목적이면 Cloud Run을 사용하면 될텐데 왜 GKE를 사용하시냐고도 여쭤봤는데 좀 더 상세하고 커스텀하게 컨테이너들을 관리하고 싶으신 것 같았다. *좀만 더 있었으면 많은 것을 더 배웠을텐데!!!!흑 너무 아쉽다.*

### 농정원 강의 영상 메타 데이터 ETL 프로젝트
개발팀에서 영상 CSV를 GCS에 올려주거나 POST요청으로 BODY에 영상 메타데이터 정보를 넘겨주면 그 메타 데이터 정보를 추출(Extract)하여 데이터를 정제(Transform)한다. 해당 메타데이터의 영상 URL의 접속하여 해당 영상 파일을 다운로드 받아 GCS에 업로드한다. 해당 영상 URL 중 .asx가 있는데 이를 .mp4로 변환 후 URL을 다시 저장한다. HTTP 상태 값을 status에 저장, ETL 작업 진행 중에 LOG들을 저장하는 등 데이터를 정제 후 최종 Google Cloud NoSQL DB인 Firestore에 저장(Load)한다.

이 ETL 애플리케이션은 Docker 이미지로 말아서 Cloud Run을 사용해 배포했다. 요청 기반, 최대 동시 요청 수 1개, 최소 인스턴스 수 0개 - 최대 인스턴스 수 20개로 설정해서 ETL 요청에 따른 자동으로 스케일 아웃처리 되게 구현했다. 

이 프로젝트를 진행하면서 네트워크 I/O처리를 어떻게 효율적으로 처리할까 고민했었다. CPU 연산이 아니라 I/O 바운드이기에 GIL(Global Interpreter Lock)과도 상관없고 멀티스레드를 도입하면 좋겠다 생각이 들었다. 이후 멀티스레드의 개수가 많으면 많을 수록 네트워크 I/O 처리를 나누어서 가져가니 효과적이라 생각하고 50개를 도입했었다. 

도입 후 인턴 생활 중 가장 고민을 많이 했던 문제인 `ConnectionResetError`를 만난다. 이 에러를 해결하기 위해 근본적인 네트워크 지식부터 시작해서 원인을 찾아나섰다. 최종적으로 대량의 스레드가 동시에 네트워크를 사용하여 생긴 네트워크 대역폭 문제로 인한 각 스레드가 쓸 수 있는 대역폭이 줄어들며 다운로드, 업로드 속도가 줄어 병목이 발생했다. 이를 해결하기 위한 방법으로는 크게 두 가지가 있었는데 STS(Storage Transfer Service)를 활용하는 것과 스레드 수를 현실적으로 줄이는 방법이었다. 인턴 기간의 남은 시간 관계상 STS는 러닝커브가 있다는 사수분의 의견으로 인해 스레드 수를 현실적으로 줄이는 방안으로 배포가 진행되었다. 


사실 일하면서 취업준비도 같이 했어야 했는데 그렇게 하지 못했다. 일하는게 너무 재밌었고 한 번에 두 가지 일을 잘 못하는 성격이기에 현재의 일에 집중했다. 일 하는데 공부가 되고 얼마 안되지만 돈도 벌리고 너무 재밌었고 신나는 두 달간의 인턴생활이었다. 하 진짜 여건만 된다면 다시 밥똥개(밥먹고 똥사고 개발만하는)가 되고 싶었다. IT 업계로 업직종 전환하기 너무 잘한 것 같다. 일하면서 행복할 수 있다니!!

원래 인턴 근무시간은 9시-15시까지 점심시간 제외 5시간 근무인데, 정직원분들보다 늦게가고 거기 정직원분들이 왜 집에 안가시냐고 물어보고 ㅋㅋ 본인들도 안가면서~~ 열정 넘치는 회사였다. 다들 잘 챙겨주시고 너무나도 행복했던 두 달간의 생활이었습니다. 끝! 